(this["webpackJsonpmlt-2.0"]=this["webpackJsonpmlt-2.0"]||[]).push([[0],{75:function(t,e,a){},82:function(t,e,a){},83:function(t,e,a){"use strict";a.r(e);var n=a(0),i=a(2),r=a.n(i),s=a(32),c=a.n(s),o=(a(75),a(6)),l=a(25),d=a(7),u=a(8),h=a(9),m=a(10),f=a(3),j=a(4),b=a(5),v=[];function y(t,e,a){for(var n=["song","artist","album"],i=["Song","Artist","Album"],r=function(r){if(t===n[r])return{v:a.filter((function(t){return t[i[r]]===e}))}},s=0;s<n.length;s++){var c=r(s);if("object"===typeof c)return c.v}return[]}var p=function(t,e,a){for(var n=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],i=new Map,r=0;r<t.length;r++){var s=t[r];if(s.RawDateTime){s.ConvertedDateTime=new Date(s.RawDateTime),s.ConvertedDateTime.setHours(s.ConvertedDateTime.getHours()-5),s.Date=new Date(s.ConvertedDateTime.toDateString()),s.Time=(new Date).setHours(s.ConvertedDateTime.getHours(),s.ConvertedDateTime.getMinutes()),s.Day=n[s.ConvertedDateTime.getDay()];var c=s.Date.getFullYear();i.has(c)||i.set(c,{yearArr:[],1:[],2:[],3:[],4:[],5:[],6:[],7:[],8:[],9:[],10:[],11:[],12:[]});var o=i.get(c),l=o[s.Date.getMonth()+1];s.monthID=l.length,s.yearID=o.yearArr.length,s.ID=r,l.push(s),o.yearArr.push(s)}else t.splice(r,1),r--}var d=new Date("".concat(t[0].Date.getMonth()+2," 1 ").concat(t[0].Date.getFullYear())),u=new Date(t[t.length-1].Date);d.setHours(0,0,0,d.getMilliseconds()-1),u.setDate(1),e(i,t,[u,d]),a(d.getMonth()+1,d.getFullYear())},g=function(t,e){for(var a=t[0].Date.getFullYear(),n=t[t.length-1].Date.getFullYear(),i=a,r=[];i>=n;)r.push(i),i-=1;e(r)},x=function(){var t=document.getElementById("loading"),e=document.getElementById("content-container");t.style.display="none",e.style.display="block"},D=function(t,e,a){v=f.c("/Music-Listening-Times-v2.0/lastfm-data-utf.csv").then((function(t){return t})),function(t,e){v.then((function(a){p(a,t,e)}))}(t,e),function(t){v.then((function(e){g(e,t)}))}(a),x()},O=function(t,e){return new Date(e,t,1)},w=function(t,e){return new Date(e,t-2,1)},k=950,C=540,S=90,F=40,N=10,T=60,P={},M={},L={},A={},I={},B=new Map([["none",[.3,3]],["day",[.3,3]],["search",[.5,5]],["select",[.7,7]],["hidden",[.05,3]]]),Y=new Map([["none",[.3,2]],["day",[.3,2]],["search",[.4,3]],["select",[.7,7]],["hidden",[.03,2]]]),G=function(t){Object(h.a)(a,t);var e=Object(m.a)(a);function a(t){var n;return Object(d.a)(this,a),(n=e.call(this,t)).initializeGraph=function(){P=f.g("#main-graph").attr("width",k).attr("height",C).attr("viewBox",[0,0,k,C]).attr("preserveAspectRatio","xMidYMid meet").classed("svg-content",!0),M=f.g("#canvas").attr("width",k).attr("height",45),L=P.append("g").attr("class","x axis").attr("transform","translate(0, ".concat(C-T,")")),A=P.append("g").attr("class","y axis").attr("transform","translate(".concat(S,", 0)"));var t=new Date;t.setHours(0,0,0,0);var e=new Date;e.setHours(23,59,59,59),I=f.f().domain([t,e]).range([S,k-F]);var a=P.append("path").style("stroke","var(--secondary-color").style("stroke-width","3px").style("stroke-dasharray","4");P.on("mousemove",(function(t){var e=f.e(t);a.attr("d",(function(){var t="M"+e[0]+",0 ";return t+="L"+e[0]+",".concat(C-T)}))})).on("mouseover",(function(){a.style("opacity",.4)})).on("mouseout",(function(){a.style("opacity",0)})),P.append("text").attr("class","x label").attr("text-anchor","middle").attr("transform","translate(".concat((S+k-F)/2,", ").concat(C-T/4,")")).text("Time of Day (hrs:mins)"),P.append("text").attr("class","x label").attr("text-anchor","middle").attr("transform","translate(".concat(S/4,", ").concat((N+C-T)/2,") rotate(-90)")).text("Date")},n.drawGraph=function(){var t=n.props,e=t.data,a=t.setClickedPoint,i=t.setFilteredDataset,r=t.sampleDate,s=t.timePeriod,c=function(t,e){if("monthly"===e){var a=t.getFullYear(),n=t.getMonth(),i=new Date(a,n,1);return[new Date(a,n+1,0),i]}if("yearly"===e){var r=t.getFullYear(),s=new Date("1 1 ".concat(r)),c=new Date("1 1 ".concat(r+1));return c.setDate(c.getDate()-1),[c,s]}}(r,s),o=f.f().domain(c).range([N,C-T]),l=f.a(I).ticks(f.i.every(1)).tickFormat(f.h("%H:%M")),d=f.b(o);L.call(l),A.call(d);var u=e||[];P.select(".no-data-message").remove(),0===u.length&&P.append("text").attr("class","no-data-message").attr("text-anchor","middle").attr("transform","translate(".concat((S+k-F)/2,", ").concat((C-T-N)/2,")")).text("No data for ".concat(r.toLocaleString("default",{month:"long",year:"numeric"})));var h=P.selectAll(".point").data(u,(function(t){return t.ConvertedDateTime})),m=h.enter().append("g").attr("class","point");m.merge(h).attr("transform",(function(t){return"translate("+[I(t.Time),o(t.Date)]+")"}));var j="monthly"===s?B:Y,b=j.get("none")[0],v=j.get("none")[1];m.append("circle").attr("r",v).style("opacity",b).on("click",(function(t,e){a(e.ID),i([e],"select")})),h.exit().remove(),n.drawCanvasBars(u)},n.updateGraph=function(){var t=n.props,e=t.filteredData,a=t.filterView,i=t.timePeriod,r=P.selectAll(".point").data(e,(function(t){return t.ConvertedDateTime})),s="monthly"===i?B:Y,c=s.get(a)[0],o=s.get(a)[1],l=s.get("hidden")[0],d=s.get("hidden")[1];r.select("circle").attr("r",o).style("opacity",c),r.exit().select("circle").attr("r",d).style("opacity",l),n.drawCanvasBars(e)},n.drawCanvasBars=function(t){var e=M.node().width,a=M.node().height,n=M.node().getContext("2d");n.clearRect(0,0,e,a);for(var i=getComputedStyle(document.body).getPropertyValue("--default-rgb"),r=0;r<t.length;r++){var s=t[r];n.fillStyle="rgba(".concat(i,", .01)"),n.fillRect(I(s.Time),0,3,a)}},n.state={},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){this.initializeGraph()}},{key:"componentDidUpdate",value:function(){this.props.newLoad?this.drawGraph():this.updateGraph()}},{key:"render",value:function(){return Object(n.jsxs)("div",{children:[Object(n.jsx)("canvas",{id:"canvas"}),Object(n.jsx)("svg",{id:"main-graph"})]})}}]),a}(r.a.Component),R=function(t){Object(h.a)(a,t);var e=Object(m.a)(a);function a(t){var n;return Object(d.a)(this,a),(n=e.call(this,t)).handleChange=function(t){n.setState((function(){return{value:t.target.value}}))},n.handleSubmit=function(t){t.preventDefault();var e=n.props,a=e.setting,i=e.setFilteredDataset,r=e.data;i(y(a,n.state.value,r),"search")},n.state={value:""},n}return Object(u.a)(a,[{key:"render",value:function(){return Object(n.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(n.jsx)("input",{type:"text",id:"filter-input",list:this.props.datalist,placeholder:"Search for...",onChange:this.handleChange,value:this.state.value}),Object(n.jsx)("input",{type:"submit",className:"button",id:"submit-button",value:"Search"})]})}}]),a}(r.a.Component),V=function(t){Object(h.a)(a,t);var e=Object(m.a)(a);function a(t){var n;return Object(d.a)(this,a),(n=e.call(this,t)).handleInfoClick=function(t,e){var a=n.props,i=a.setFilteredDataset,r=a.setSearchType,s=a.data;r(t),i(y(t,e,s),"search")},n.handlePointChange=function(t){var e=n.props,a=e.setFilteredDataset,i=e.setClickedPoint,r=e.clickedPoint,s=(e.data,e.entireDataset),c=r+t;c>=0&&c<s.length&&(a([s[c]],"select"),i(c))},n.state={},n}return Object(u.a)(a,[{key:"render",value:function(){var t=this,e=this.props,a=e.clickedPoint,i=e.data,r=e.entireDataset,s=e.timePeriod,c=i;void 0===i&&(c=[]);var o=r[a];void 0===o&&(o={});var l,d,u=void 0===o.Artist?"hidden":"";return"monthly"===s?(l=o.monthID<c.length-1?"":"disabled-arrow",d=o.monthID>0?"":"disabled-arrow"):"yearly"===s&&(l=o.yearID<c.length-1?"":"disabled-arrow",d=o.yearID>0?"":"disabled-arrow"),Object(n.jsxs)("div",{className:"song-info-grid ".concat(u),children:[Object(n.jsx)("img",{id:"album-art",src:"https://lastfm.freetls.fastly.net/i/u/174s/2a96cbd8b46e442fc41c2b86b821562f.png"}),Object(n.jsxs)("div",{className:"info",children:[Object(n.jsx)("span",{className:"artist",onClick:function(){return t.handleInfoClick("artist",o.Artist)},children:o.Artist})," - ",Object(n.jsx)("span",{className:"song",onClick:function(){return t.handleInfoClick("song",o.Song)},children:o.Song})]}),Object(n.jsx)("div",{className:"info album",onClick:function(){return t.handleInfoClick("album",o.Album)},children:o.Album}),Object(n.jsx)("div",{className:"info date",children:o.ConvertedDateTime?o.ConvertedDateTime.toLocaleString("default",{weekday:"long",month:"long",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric"}):""}),Object(n.jsxs)("div",{className:"song-arrows",children:[Object(n.jsx)(j.a,{icon:b.d,onClick:function(){return t.handlePointChange(1)},className:"".concat(l," arrow"),title:"Go to next point"}),Object(n.jsx)(j.a,{icon:b.e,onClick:function(){return t.handlePointChange(-1)},className:"".concat(d," arrow"),style:{marginLeft:"10px"},title:"Go to the previous point"})]}),Object(n.jsx)("div",{id:"tagList"})]})}}]),a}(r.a.Component),H=(a(82),function(t){Object(h.a)(a,t);var e=Object(m.a)(a);function a(t){var n;return Object(d.a)(this,a),(n=e.call(this,t)).setDatasetBuckets=function(t,e,a){n.setState((function(){return{datasetBuckets:t,entireDataset:e,timeRange:a}}))},n.setDataset=function(t,e){var a=[],i=n.state,r=i.timePeriod,s=i.datasetBuckets;"monthly"===r?a=s.get(e)[t]:"yearly"===r&&(a=s.get(e).yearArr),n.setState((function(n){return{dataset:a,filteredDataset:a,filterView:"none",dayFilter:{mon:!1,tue:!1,wed:!1,thu:!1,fri:!1,sat:!1,sun:!1},month:t,year:e,newLoad:!0,clickedPoint:-1}}),(function(){n.state.dataset&&n.setDatalist()}))},n.setYearList=function(t){n.setState((function(){return{yearList:t}}))},n.setDatalist=function(){var t=new Set,e=new Set,a=new Set;n.state.dataset.forEach((function(n){t.add(n.Artist),e.add(n.Song),a.add(n.Album)}));var i=function(t,e){return t.toLowerCase().localeCompare(e.toLowerCase())},r=Array.from(t).sort(i),s=Array.from(e).sort(i),c=Array.from(a).sort(i);n.setState((function(){return{datalist:{artist:r,song:s,album:c},newLoad:!1}}))},n.setClickedPoint=function(t){n.setState((function(){return{clickedPoint:t,filterView:"select",dayFilter:{mon:!1,tue:!1,wed:!1,thu:!1,fri:!1,sat:!1,sun:!1}}}))},n.setFilteredDataset=function(t,e){n.setState((function(){return{filteredDataset:t,filterView:e,dayFilter:{mon:!1,tue:!1,wed:!1,thu:!1,fri:!1,sat:!1,sun:!1}}}))},n.toggleDarkTheme=function(){n.setState((function(t){return{isDarkTheme:!t.isDarkTheme}}))},n.setSearchType=function(t){n.setState((function(){return{datalistSetting:t}}))},n.toggleDayCheckbox=function(t){var e=t.target.name;n.setState((function(t){return{dayFilter:Object(l.a)(Object(l.a)({},t.dayFilter),{},Object(o.a)({},e,!t.dayFilter[e])),filterView:"day"}}),(function(){var t=function(t,e){var a=[],n=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],i=0;return["mon","tue","wed","thu","fri","sat","sun"].forEach((function(r,s){t[r]&&(a=a.concat(e.filter((function(t){return t.Day===n[s]}))),i++)})),i>0?a:e}(n.state.dayFilter,n.state.dataset);n.setState((function(){return{filteredDataset:t}}))}))},n.handleFileUpload=function(t){var e=t.target.files[0],a=new FileReader;a.addEventListener("load",(function(){!function(t,e,a,n){p(t,e,a),g(t,n),x()}(f.d(a.result,(function(t){return t})),n.setDatasetBuckets,n.setDataset,n.setYearList)}),!1),e&&a.readAsText(e)},n.setTimePeriod=function(t){n.setState((function(){return{timePeriod:t}}),(function(){n.setDataset(n.state.month,n.state.year)}))},n.state={isDarkTheme:!1,datasetBuckets:new Map,dataset:[],entireDataset:[],filteredDataset:[],filterView:"none",yearList:[],month:0,year:0,datalist:{artist:[],song:[],album:[]},datalistSetting:"artist",dayFilter:{mon:!1,tue:!1,wed:!1,thu:!1,fri:!1,sat:!1,sun:!1},newLoad:!1,clickedPoint:-1,timePeriod:"monthly",timeRange:[]},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){D(this.setDatasetBuckets,this.setDataset,this.setYearList)}},{key:"render",value:function(){var t=this,e=this.state,a=e.dataset,i=e.filteredDataset,r=e.entireDataset,s=e.datalist,c=e.datalistSetting,o=e.dayFilter,l=e.filterView,d=e.month,u=e.year,h=e.timePeriod,m=e.timeRange,f=e.yearList,v=e.clickedPoint,y=e.newLoad,p=e.isDarkTheme;document.getElementsByTagName("body")[0].className=p?"":"light-theme";var g=function(e){return Object(n.jsxs)("div",{id:"search-filter",children:[Object(n.jsxs)("label",{htmlFor:"general-filter",children:[Object(n.jsxs)("span",{children:[Object(n.jsx)(j.a,{icon:b.h})," Search by "]}),Object(n.jsxs)("select",{id:"filter-select",onChange:function(e){return t.setSearchType(e.target.value)},value:c,children:[Object(n.jsx)("option",{value:"artist",children:"Artist"}),Object(n.jsx)("option",{value:"song",children:"Song"}),Object(n.jsx)("option",{value:"album",children:"Album"})]})]}),Object(n.jsx)("br",{}),Object(n.jsx)(R,{setting:c,setFilteredDataset:t.setFilteredDataset,data:a,datalist:"".concat(c,"-datalist")})]})},x=function(e){var a=e.abbrevation,i=e.fullName,r=e.displayName;return Object(n.jsxs)("label",{htmlFor:a,children:[Object(n.jsx)("input",{type:"checkbox",name:a,id:a,value:i,checked:o[a],onChange:t.toggleDayCheckbox}),Object(n.jsx)("span",{className:"checkbox",children:r})]})},D=function(t){return Object(n.jsxs)("div",{id:"day-filters",children:[Object(n.jsxs)("label",{children:[Object(n.jsx)(j.a,{icon:b.c})," Filter by day of the week:"]}),Object(n.jsxs)("div",{id:"day-container",children:[Object(n.jsx)(x,{abbrevation:"mon",fullName:"Monday",displayName:"Mon"}),Object(n.jsx)(x,{abbrevation:"tue",fullName:"Tuesday",displayName:"Tue"}),Object(n.jsx)(x,{abbrevation:"wed",fullName:"Wednesday",displayName:"Wed"}),Object(n.jsx)(x,{abbrevation:"thu",fullName:"Thursday",displayName:"Thu"}),Object(n.jsx)(x,{abbrevation:"fri",fullName:"Friday",displayName:"Fri"}),Object(n.jsx)(x,{abbrevation:"sat",fullName:"Saturday",displayName:"Sat"}),Object(n.jsx)(x,{abbrevation:"sun",fullName:"Sunday",displayName:"Sun"})]})]})},k=function(e){var a=parseInt(e.target.value);t.setDataset(a,u)},C=function(e){var a=parseInt(e.target.value);t.setDataset(d,a)},S=function(e){var a,i,r=[1,2,3,4,5,6,7,8,9,10,11,12],s=O(d,u),c=w(d,u);return"monthly"===h?(a=s>m[1]?"disabled-arrow":"",i=c<m[0]?"disabled-arrow":""):"yearly"===h&&(a=-1===f.indexOf(parseInt(u)+1)&&"disabled-arrow",i=-1===f.indexOf(parseInt(u)-1)&&"disabled-arrow"),Object(n.jsxs)("div",{className:"date-navigation",children:[Object(n.jsx)(j.a,{icon:b.b,className:"up-caret arrow ".concat(i),onClick:function(){return function(e){if("monthly"===e){var a=w(d,u),n=a.getMonth()+1,i=a.getFullYear();t.setDataset(n,i)}else"yearly"===e&&t.setDataset(d,parseInt(u)-1)}(h)},title:"Go to previous ".concat("monthly"===h?"month":"year")}),Object(n.jsx)(j.a,{icon:b.a,className:"down-caret arrow ".concat(a),onClick:function(){return function(e){if("monthly"===e){var a=O(d,u),n=a.getMonth()+1,i=a.getFullYear();t.setDataset(n,i)}else"yearly"===e&&t.setDataset(d,parseInt(u)+1)}(h)},title:"Go to the next ".concat("monthly"===h?"month":"year")}),"monthly"===h&&Object(n.jsx)("select",{id:"month-select",onChange:k,value:d,children:["January","February","March","April","May","June","July","August","September","October","November","December"].map((function(t,e){return Object(n.jsx)("option",{value:r[e],children:t})}))}),Object(n.jsx)("select",{id:"year-select",onChange:C,value:u,children:f.map((function(t){return Object(n.jsx)("option",{value:t,children:t})}))})]})},F=function(e){var a=e.value;return Object(n.jsxs)("span",{className:"time-period-button",children:[Object(n.jsx)("input",{id:a,type:"radio",value:a,name:"time-period",checked:h===a,onChange:function(){return t.setTimePeriod(a)}}),Object(n.jsx)("label",{htmlFor:a,children:a})]})};return Object(n.jsxs)("div",{className:"site-container",children:[Object(n.jsxs)("div",{id:"loading",children:[Object(n.jsx)("div",{className:"lds-dual-ring"}),Object(n.jsx)("h2",{children:"Loading..."})]}),Object(n.jsxs)("div",{id:"content-container",children:[Object(n.jsxs)("div",{id:"side-options-container",onClick:this.toggleDarkTheme,children:[Object(n.jsxs)("label",{htmlFor:"file-upload",className:"side-option button",children:[Object(n.jsx)(j.a,{icon:b.j})," Import CSV"]}),Object(n.jsx)("input",{id:"file-upload",type:"file",accept:".csv",onChange:this.handleFileUpload}),Object(n.jsx)("div",{className:"button side-option",children:p?Object(n.jsx)(j.a,{icon:b.f}):Object(n.jsx)(j.a,{icon:b.i})})]}),Object(n.jsx)("h1",{children:"Music Listening Times"}),Object(n.jsxs)("div",{className:"info-grid",children:[Object(n.jsx)(g,{}),Object(n.jsx)(D,{}),Object(n.jsxs)("button",{id:"reset",className:"button",onClick:function(){return t.setDataset(d,u)},children:[Object(n.jsx)(j.a,{icon:b.g,flip:"horizontal"})," Reset"]}),Object(n.jsx)(V,{clickedPoint:v,setFilteredDataset:this.setFilteredDataset,setSearchType:this.setSearchType,setClickedPoint:this.setClickedPoint,data:a,entireDataset:r,timePeriod:h})]}),Object(n.jsxs)("div",{className:"time-settings",children:[Object(n.jsxs)("div",{className:"time-period",children:[Object(n.jsx)(F,{value:"monthly"}),Object(n.jsx)(F,{value:"yearly"})]}),Object(n.jsxs)("div",{className:"side-container",children:[Object(n.jsxs)("div",{id:"entries",children:[i?i.length:0," entries"]}),Object(n.jsx)(S,{})]})]}),Object(n.jsx)("div",{id:"main",children:Object(n.jsx)(G,{data:a,filteredData:i,filterView:l,newLoad:y,setClickedPoint:this.setClickedPoint,setFilteredDataset:this.setFilteredDataset,sampleDate:new Date("".concat(d," 1 ").concat(u)),timePeriod:h})})]}),Object(n.jsx)("datalist",{id:"artist-datalist",children:s.artist.map((function(t){return Object(n.jsx)("option",{children:t})}))}),Object(n.jsx)("datalist",{id:"song-datalist",children:s.song.map((function(t){return Object(n.jsx)("option",{children:t})}))}),Object(n.jsx)("datalist",{id:"album-datalist",children:s.album.map((function(t){return Object(n.jsx)("option",{children:t})}))})]})}}]),a}(r.a.Component)),E=function(t){t&&t instanceof Function&&a.e(3).then(a.bind(null,84)).then((function(e){var a=e.getCLS,n=e.getFID,i=e.getFCP,r=e.getLCP,s=e.getTTFB;a(t),n(t),i(t),r(t),s(t)}))};c.a.render(Object(n.jsx)(r.a.StrictMode,{children:Object(n.jsx)(H,{})}),document.getElementById("root")),E()}},[[83,1,2]]]);
//# sourceMappingURL=main.5e4c8747.chunk.js.map